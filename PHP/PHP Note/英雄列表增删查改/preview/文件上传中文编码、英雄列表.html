<html>
  <head>
	  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>文件上传中文编码、英雄列表</title>
		<link href="toc/style/github-bf51422f4bb36427d391e4b75a1daa083c2d840e.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/style/github2-d731afd4f624c99a4b19ad69f3083cd6d02b81d5.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/css/zTreeStyle/zTreeStyle.css" media="all" rel="stylesheet" type="text/css"/>
	  <style>
		pre {
		    counter-reset: line-numbering;
		    border: solid 1px #d9d9d9;
		    border-radius: 0;
		    background: #fff;
		    padding: 0;
		    line-height: 23px;
		    margin-bottom: 30px;
		    white-space: pre;
		    overflow-x: auto;
		    word-break: inherit;
		    word-wrap: inherit;
		}

		pre a::before {
		  content: counter(line-numbering);
		  counter-increment: line-numbering;
		  padding-right: 1em; /* space after numbers */
		  width: 25px;
		  text-align: right;
		  opacity: 0.7;
		  display: inline-block;
		  color: #aaa;
		  background: #eee;
		  margin-right: 16px;
		  padding: 2px 10px;
		  font-size: 13px;
		  -webkit-touch-callout: none;
		  -webkit-user-select: none;
		  -khtml-user-select: none;
		  -moz-user-select: none;
		  -ms-user-select: none;
		  user-select: none;
		}

		pre a:first-of-type::before {
		  padding-top: 10px;
		}

		pre a:last-of-type::before {
		  padding-bottom: 10px;
		}

		pre a:only-of-type::before {
		  padding: 10px;
		}

		.highlight { background-color: #ffffcc } /* RIGHT */
		</style>
  </head>
  <body>
	  <div>
				<div style='width:25%;'>
						<ul id="tree" class="ztree" style='width:100%'>

						</ul>
				</div>
        <div id='readme' style='width:70%;margin-left:20%;'>
          	<article class='markdown-body'>
            	<hr>
<p>typora-root-url: media</p>
<h2 id="typora-copy-images-to-media">typora-copy-images-to: media</h2>
<h2 id="1-">1.上传中文文件时的编码问题</h2>
<h3 id="1-1-">1.1 问题描述</h3>
<ul>
<li>当我们写一个上传文件操作时，如果上传的文件时中文名，可能会存在乱码问题。</li>
<li>例：首页代码如下：</li>
</ul>
<pre><code class="lang-html">    &lt;form action=&quot;upload.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;input type=&quot;file&quot; name=&quot;icon&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;&gt;
    &lt;/form&gt;
</code></pre>
<ul>
<li>提交到upload.php，upload.php代码如下：</li>
</ul>
<pre><code class="lang-php">&lt;?php

    //拿到临时文件位置
    $tmp = $_FILES[&#39;icon&#39;][&#39;tmp_name&#39;];
    //拿到文件名
    $name = $_FILES[&#39;icon&#39;][&#39;name&#39;];

    //使用文件移动函数移动到当前位置来
    move_uploaded_file($tmp,&#39;./&#39;.$name);
?&gt;
</code></pre>
<ul>
<li><p>我们可以看到，如果选择中文文件，例如上传下面这张图</p>
<p><img src="media/1523519124645.png" alt="1523519124645"></p>
</li>
</ul>
<ul>
<li><p>则发现：<strong>文件名会变成乱码！</strong>，如图</p>
<p><img src="media/1523519274015.png" alt="1523519274015"></p>
</li>
</ul>
<h3 id="1-2-">1.2 原因解析（了解即可）</h3>
<pre><code>我们的网页编码是UTF-8编码，通过使用utf-8字符集的网页在把文件名传过来时也是UTF-8的编码。但是phpStduy服务器使用的是中文windows系统，中文windows系统的内置字符集处理编码是GBK。所以当你把UTF-8的编码的文件要写入到操作系统时，它会按照GBK的编码来写入。编码格式不对，自然出现乱码。
</code></pre><h3 id="1-3-">1.3 解决办法</h3>
<ul>
<li>只需要将UTF-8的文件名先转成GBK的文件名，就可以成功写入了。</li>
<li>需要用到  <code>iconv</code>  函数</li>
<li>用法：</li>
</ul>
<pre><code class="lang-php">转换后的结果 = iconv(&#39;原编码格式&#39;,&#39;转成什么编码格式&#39;,&#39;转什么内容&#39;);
</code></pre>
<ul>
<li>解析：<ul>
<li>参数1：传入原本的编码格式，传字符串</li>
<li>参数2：传入目标编码格式，也是字符串</li>
<li>参数3：转什么内容</li>
<li>返回值：会把转换的内容按照目标编码格式转换后当返回值返回。</li>
</ul>
</li>
</ul>
<ul>
<li>最终代码为：</li>
</ul>
<pre><code class="lang-php">&lt;?php

    //拿到临时文件位置
    $tmp = $_FILES[&#39;icon&#39;][&#39;tmp_name&#39;];
    //拿到文件名
    $name = $_FILES[&#39;icon&#39;][&#39;name&#39;];

    //转换成GBK的文件名
    $newName = iconv(&#39;utf-8&#39;,&#39;gbk&#39;,$name);

    //使用文件移动函数移动到当前位置来
    move_uploaded_file($tmp,&#39;./&#39;.$newName);
?&gt;
</code></pre>
<blockquote>
<p>总结：具体原因只要知道有那么回事就行了，主要要学习处理上传中文文件有乱码时，用iconv函数处理</p>
</blockquote>
<h2 id="2-">2.英雄列表</h2>
<h3 id="2-1-">2.1 学习目标</h3>
<ul>
<li>增强代码实现业务能力</li>
<li>掌握页面的增删查改</li>
</ul>
<p> 效果如图：</p>
<p><img src="media/1523428598410.png" alt="1523428598410"></p>
<h3 id="2-2-">2.2 数据库分析</h3>
<h4 id="2-2-1-">2.2.1 数据库、表、字段介绍</h4>
<p><img src="media/1523429335338.png" alt="1523429335338"></p>
<ul>
<li>数据库：<code>test</code></li>
<li>表：<code>hero_recycle</code>，所有页面需要的  <code>数据</code>  都在这张表里，如图：</li>
</ul>
<p><img src="media/1523429933010.png" alt="1523429933010"></p>
<blockquote>
<p>字段说明</p>
<p><code>id</code>：数据的唯一标识，用来区分是哪条数据</p>
<p><code>heroName</code>：英雄名</p>
<p><code>heroIcon</code>：英雄头像的路径</p>
<p><code>heroSkill</code>：英雄技能</p>
<p><code>isDelete</code>：是否加入回收站的标识</p>
</blockquote>
<h4 id="2-2-2-">2.2.2 字段分析</h4>
<ul>
<li><code>id</code>是为了方便找到具体某条数据，也为了展示在界面上做序号</li>
<li><code>id</code>，<code>heroName</code>，<code>heroIcon</code>，<code>heroSkill</code>，这三个字段是用来显示到界面上的，分别对应了名字、头像地址、技能。</li>
<li>如图：</li>
</ul>
<p><img src="media/1523430527902.png" alt="1523430527902"></p>
<ul>
<li><code>heroIcon</code>里保存的只是路径，而不是真正的图片，我们到时需要用<code>img</code>标签搭配使用</li>
<li>由界面可知，我们有<code>删除</code>、<code>回收站</code>两个按钮。</li>
<li>所以可以得知，当我们对某条数据点击<code>删除</code>时，其实不是真正永久删除它，而是把它放入了<code>回收站</code></li>
<li>因此，<code>isDelete</code>这个字段，就是用来区分是否加入回收站的，默认值为<code>no</code>，代表没加入，如果改为<code>yes</code>，代表加入了回收站</li>
</ul>
<h3 id="3-">3. 首页展示英雄列表</h3>
<ul>
<li>由于我们本次课程的重点在于后台交互的开发， 因此布局等代码忽略。直接用已有的模板（需要导入imgs、lib两个文件夹）。</li>
</ul>
<h5 id="3-1-">3.1 页面结构</h5>
<ul>
<li>新建<code>index.php</code>文件，代码如下（讲师带领学员看大概的布局和结构）：</li>
</ul>
<pre><code class="lang-php+HTML">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-cn&quot;&gt;

&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;title&gt;Bootstrap 101 Template&lt;/title&gt;

  &lt;!-- Bootstrap --&gt;
  &lt;link href=&quot;lib/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;

  &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
  &lt;!-- WARNING: Respond.js doesn&#39;t work if you view the page via file:// --&gt;
  &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
      &lt;![endif]--&gt;
  &lt;style&gt;
    .input-group {
      margin: 20px 0;
    }

    .form-group {
      display: flex;
    }

    .form-group&gt;* {
      flex: 1;
      margin: 10px;
    }

    table {
      background-color: white;
    }

    a {
      text-decoration: none !important;
    }

    table {
      font-size: 25px;
    }

    td {
      vertical-align: middle !important;
    }

    tr td:last-child {
      text-align: center;
    }

    img {
      width: 140px !important;
    }
  &lt;/style&gt;
&lt;/head&gt;

&lt;body class=&#39;bg-success&#39;&gt;
  &lt;nav class=&quot;navbar navbar-default&quot;&gt;
    &lt;div class=&quot;container-fluid&quot;&gt;
      &lt;!-- Brand and toggle get grouped for better mobile display --&gt;
      &lt;div class=&quot;navbar-header&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot;
          aria-expanded=&quot;false&quot;&gt;
          &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
        &lt;/button&gt;
        &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;英雄管理--
          &lt;span&gt;首页&lt;/span&gt;
        &lt;/a&gt;
      &lt;/div&gt;

      &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;
      &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt;
        &lt;ul class=&quot;nav navbar-nav&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;首页&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;新增&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
        &lt;form class=&quot;navbar-form navbar-left&quot; style=&quot;margin:0&quot; role=&quot;search&quot;&gt;
          &lt;div class=&quot;form-group&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Search&quot;&gt;
          &lt;/div&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;搜索&lt;/button&gt;
        &lt;/form&gt;
        &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;回收站&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
      &lt;!-- /.navbar-collapse --&gt;
    &lt;/div&gt;
    &lt;!-- /.container-fluid --&gt;
  &lt;/nav&gt;
  &lt;div class=&quot;container&quot;&gt;

    &lt;table class=&quot;table table-bordered  table-striped&quot;&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th width=&#39;10%&#39;&gt;序号&lt;/th&gt;
          &lt;th width=&#39;10%&#39;&gt;姓名&lt;/th&gt;
          &lt;th width=&#39;10%&#39;&gt;头像&lt;/th&gt;
          &lt;th width=&#39;55%&#39;&gt;技能&lt;/th&gt;
          &lt;th width=&#39;20%&#39;&gt;管理&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;jack&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2444417686,1560113072&amp;fm=58&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;擅长游泳&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;编辑&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;删除&lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;jack&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=3285008674,1557983093&amp;fm=27&amp;gp=0.jpg&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;擅长游泳&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;编辑&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;删除&lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
&lt;!-- jQuery (necessary for Bootstrap&#39;s JavaScript plugins) --&gt;
&lt;script src=&quot;lib/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;
&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;
&lt;script src=&quot;lib/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<blockquote>
<p>经过分析，我们可以知道，其实每条数据就是一行<code>tr</code>，因此，我们只要从数据库中先查出所有数据，再数据有多少条，就生成多少个<code>tr</code>即可。</p>
</blockquote>
<h5 id="3-2-">3.2 具体思路流程：</h5>
<pre><code>   1. 连接数据库，写好查询语句，查询出数据
   2. 遍历查询出来的数据
   3. 在每次循环内生成tr，在td内取出每个对应的数据
</code></pre><h5 id="3-3-">3.3 核心代码</h5>
<ul>
<li>在 <code>index.php</code>的第 <code>114</code> 行 <code>&lt;tbody&gt;</code> 下面开始，写如下代码：</li>
</ul>
<pre><code class="lang-php+HTML">&lt;tbody&gt;
&lt;?php

  //连接数据库
  $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);
  //查询数据的sql语句（查询出所有不在回收站的数据）
  $sql = &quot;select * from hero_recycle where isDelete=&#39;no&#39;&quot;;

  //执行语句
  $result = mysqli_query($link,$sql);

  //拿到结果
  $data = mysqli_fetch_all($result,1);
  //关闭连接
  mysqli_close($link);    

  //遍历查到的所有数据
  for($i = 0; $i &lt; count($data); $i++):
?&gt;
    &lt;!-- 根据数据生成表格 --&gt;
    &lt;tr&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;Id&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;heroName&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;&lt;?php echo $data[$i][&#39;heroIcon&#39;];?&gt;&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;heroSkill&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;编辑&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;删除&lt;/a&gt;
          &lt;/td&gt;
     &lt;/tr&gt;
  &lt;?php endfor; ?&gt;

&lt;/tbody&gt;
</code></pre>
<h5 id="3-4-">3.4 易错点：</h5>
<ul>
<li>写循环增量 <code>$i</code> 时，很容易因为JS的习惯，忘记写<code>$</code></li>
<li>在给<code>td</code>标签内取数据时，很容易忘记写 <code>echo</code></li>
<li>很容易在最后忘记写  <code>&lt;?php endfor; ?&gt;</code></li>
</ul>
<blockquote>
<p>写代码时请一定要细心，留意这些细节！</p>
</blockquote>
<h3 id="4-">4.完成新增功能</h3>
<h5 id="4-1-">4.1 准备新增页面</h5>
<ul>
<li>在  <code>index.php</code>  的 <code>83</code>  行 新增的这个a标签中，把href改为<code>add.html</code></li>
<li>然后新建一个新建页面   <code>add.html</code>，代码如下：</li>
</ul>
<pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-cn&quot;&gt;

&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;title&gt;Bootstrap 101 Template&lt;/title&gt;

  &lt;!-- Bootstrap --&gt;
  &lt;link href=&quot;lib/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;

  &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
  &lt;!-- WARNING: Respond.js doesn&#39;t work if you view the page via file:// --&gt;
  &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
      &lt;![endif]--&gt;
  &lt;style&gt;
    .input-group {
      margin: 20px 0;
    }

    .form-group {
      display: flex;
    }

    .form-group&gt;* {
      flex: 1;
      margin: 10px;
    }

    a {
      text-decoration: none !important;
    }

    img {
      width: 150px !important;
    }
  &lt;/style&gt;
&lt;/head&gt;

&lt;body class=&#39;bg-success&#39;&gt;
  &lt;nav class=&quot;navbar navbar-default&quot;&gt;
    &lt;div class=&quot;container-fluid&quot;&gt;
      &lt;!-- Brand and toggle get grouped for better mobile display --&gt;
      &lt;div class=&quot;navbar-header&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot;
          aria-expanded=&quot;false&quot;&gt;
          &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
        &lt;/button&gt;
        &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;英雄管理--
          &lt;span&gt;新增页&lt;/span&gt;
        &lt;/a&gt;
      &lt;/div&gt;

      &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;
      &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt;
        &lt;ul class=&quot;nav navbar-nav&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;首页&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;新增&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
        &lt;form class=&quot;navbar-form navbar-left&quot; style=&quot;margin:0&quot; role=&quot;search&quot;&gt;
          &lt;div class=&quot;form-group&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Search&quot;&gt;
          &lt;/div&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;搜索&lt;/button&gt;
        &lt;/form&gt;
        &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;回收站&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
      &lt;!-- /.navbar-collapse --&gt;
    &lt;/div&gt;
    &lt;!-- /.container-fluid --&gt;
  &lt;/nav&gt;
  &lt;div class=&quot;container&quot;&gt;

    &lt;div class=&quot;jumbotron&quot;&gt;
      &lt;!-- 提交到doAdd.php页面 --&gt;
      &lt;form action=&quot;doAdd.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon1&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-cutlery&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;text&quot; name=&#39;heroName&#39; class=&quot;form-control&quot; placeholder=&quot;请输入人员姓名&quot; aria-describedby=&quot;basic-addon1&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-thumbs-up&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;text&quot; name=&#39;heroSkill&#39; class=&quot;form-control&quot; placeholder=&quot;请输入技能名&quot; aria-describedby=&quot;basic-addon2&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-picture&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;file&quot; name=&#39;heroIcon&#39; class=&quot;form-control&quot; aria-describedby=&quot;&quot; required&gt;
        &lt;/div&gt;

        &lt;div class=&quot;form-group&quot;&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;保存&lt;/button&gt;
          &lt;a href=&#39;#&#39; class=&quot;btn btn-danger&quot;&gt;取消&lt;/a&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
&lt;!-- jQuery (necessary for Bootstrap&#39;s JavaScript plugins) --&gt;
&lt;script src=&quot;lib/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;
&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;
&lt;script src=&quot;lib/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;
  $(function () {
    $(&#39;[name=userIcon]&#39;).blur(function () {
      $(&#39;img.preview&#39;).attr(&#39;src&#39;, $(this).val());

    })
  })
&lt;/script&gt;
</code></pre>
<p>效果图：</p>
<p><img src="media/1523440319347.png" alt="1523440319347"></p>
<h5 id="4-2-">4.2 完成新增功能</h5>
<blockquote>
<p> 我们发现，当用户点击保存后，会把数据提交到 <code>doAdd.php</code>这个页面，会提交的内容依次有 <code>heroName</code>，<code>heroSkill</code>，<code>heroIcon</code>  因此，我们新建<code>doAdd.php</code> 这个页面，处理把输入的数据插入到数据库的功能。</p>
</blockquote>
<ul>
<li>代码如下：</li>
</ul>
<pre><code class="lang-php">&lt;?php

    //接收文件名
    $fileName = $_FILES[&#39;heroIcon&#39;][&#39;name&#39;];

    //找到临时保存的文件
    $tmp = $_FILES[&#39;heroIcon&#39;][&#39;tmp_name&#39;];

    //转换成gbk编码的文件名
    $gbkName = iconv(&#39;utf-8&#39;,&#39;gbk&#39;,$fileName);

    //拼接要永久保存图片的路径
    $path = &#39;./imgs/icon/&#39;.$gbkName;

    //移动到图片文件夹永久保存
    move_uploaded_file($tmp,$path);

    //连接数据库
    $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);

    //得到名字
    $name = $_POST[&#39;heroName&#39;];
    //得到技能
    $skill = $_POST[&#39;heroSkill&#39;];

    //新增数据
    $sql = &quot;insert into hero_recycle(heroName,heroIcon,heroSkill) values(&#39;$name&#39;,&#39;$path&#39;,&#39;$skill&#39;)&quot;;

    //执行语句
    $result = mysqli_query($link,$sql);

    //获得受影响行数
    $rows = mysqli_affected_rows($link);

    //关闭连接
    mysqli_close($link);    

    //如果成功
    if($rows &gt; 0){

        //返回首页
        header(&#39;location:index.php&#39;);

    }else{

        echo &#39;新增失败！！！&#39;;
    }
?&gt;
</code></pre>
<h3 id="5-">5. 完成编辑功能</h3>
<p><strong>需求</strong>：点击某条数据的编辑后，会进入到编辑界面，并把需要修改的原来数据展示到编辑界面窗口。</p>
<p>在首页<code>index.php</code>界面中，我们可以看到每条数据右边都有个<code>编辑</code>按钮，点击它会跳转到<code>update.php</code>界面并把自己的序号通过url传递过去，再进行编辑，因此，我们现在需要完成这个界面的工作。</p>
<h4 id="5-1-">5.1 搭建编辑界面</h4>
<ul>
<li>新建<code>update.php</code>界面，代码如下：（下面仅仅只是update的界面布局）</li>
</ul>
<pre><code class="lang-php+HTML">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-cn&quot;&gt;

&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;title&gt;Bootstrap 101 Template&lt;/title&gt;

  &lt;!-- Bootstrap --&gt;
  &lt;link href=&quot;lib/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;

  &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
  &lt;!-- WARNING: Respond.js doesn&#39;t work if you view the page via file:// --&gt;
  &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
      &lt;![endif]--&gt;
  &lt;style&gt;
    .input-group {
      margin: 20px 0;
    }

    .form-group {
      display: flex;
    }

    .form-group&gt;* {
      flex: 1;
      margin: 10px;
    }

    a {
      text-decoration: none !important;
    }

    img {
      width: 150px !important;
    }
  &lt;/style&gt;
&lt;/head&gt;

&lt;body class=&#39;bg-success&#39;&gt;
  &lt;nav class=&quot;navbar navbar-default&quot;&gt;
    &lt;div class=&quot;container-fluid&quot;&gt;
      &lt;!-- Brand and toggle get grouped for better mobile display --&gt;
      &lt;div class=&quot;navbar-header&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot;
          aria-expanded=&quot;false&quot;&gt;
          &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
        &lt;/button&gt;
        &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;英雄管理--
          &lt;span&gt;编辑页&lt;/span&gt;
        &lt;/a&gt;
      &lt;/div&gt;

      &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;
      &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt;
        &lt;ul class=&quot;nav navbar-nav&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;首页&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;新增&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
        &lt;form class=&quot;navbar-form navbar-left&quot; style=&quot;margin:0&quot; role=&quot;search&quot;&gt;
          &lt;div class=&quot;form-group&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Search&quot;&gt;
          &lt;/div&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;搜索&lt;/button&gt;
        &lt;/form&gt;
        &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;回收站&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
      &lt;!-- /.navbar-collapse --&gt;
    &lt;/div&gt;
    &lt;!-- /.container-fluid --&gt;
  &lt;/nav&gt;
  &lt;div class=&quot;container&quot;&gt;

    &lt;div class=&quot;jumbotron&quot;&gt;
      &lt;!-- 从这开始是修改界面核心输入数据部分 --&gt;
      &lt;form action=&quot;doUpdate.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon1&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-cutlery&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;text&quot; name=&#39;heroName&#39; class=&quot;form-control&quot; placeholder=&quot;请输入人员姓名&quot; aria-describedby=&quot;basic-addon1&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-thumbs-up&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;text&quot; name=&#39;heroSkill&#39; class=&quot;form-control&quot; placeholder=&quot;请输入技能名&quot; aria-describedby=&quot;basic-addon2&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-picture&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;file&quot; name=&#39;heroIcon&#39; class=&quot;form-control&quot; aria-describedby=&quot;&quot; required&gt;
        &lt;/div&gt;

        &lt;div class=&quot;form-group&quot;&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;保存&lt;/button&gt;
          &lt;a href=&#39;#&#39; class=&quot;btn btn-danger&quot;&gt;取消&lt;/a&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
&lt;!-- jQuery (necessary for Bootstrap&#39;s JavaScript plugins) --&gt;
&lt;script src=&quot;lib/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;
&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;
&lt;script src=&quot;lib/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  $(function () {
    $(&#39;[name=userIcon]&#39;).blur(function () {
      if ($(this).val().trim() != &#39;&#39;) {
        $(&#39;img.preview&#39;).attr(&#39;src&#39;, $(this).val());
      }
    })
  })
&lt;/script&gt;
</code></pre>
<h4 id="5-2-">5.2 进入编辑界面时有原数据</h4>
<ul>
<li>因为我们的业务是点击某条数据的编辑后进入编辑界面，按照编辑的逻辑，我们应该在出现界面的时候，先显示这条数据的原数据。</li>
<li>如图：</li>
</ul>
<p><img src="media/1523497164035.png" alt="1523497164035"></p>
<h4 id="5-3-">5.3 点击打开更新界面并传递数据</h4>
<blockquote>
<p>我们需要点击 <code>编辑</code> 按钮时要跳转到<code>update.php</code>页面,除此以外还要能带入数据，怎么办呢？按照我们目前阶段，我们可以<strong>把被点击那条数据的编号传递过去</strong>，然后在<code>update.php</code>界面，根据这个编号查询出这条数据，把数据显示在界面上（以后有更好的做法）</p>
</blockquote>
<ul>
<li>来到<code>index.php</code>界面，修改 <code>142</code> 行，即以下代码：</li>
</ul>
<pre><code class="lang-php+HTML">&lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;编辑&lt;/a&gt;
</code></pre>
<ul>
<li>修改为</li>
</ul>
<pre><code class="lang-php+HTML">&lt;a href=&quot;update.php?id=&lt;?php echo $data[$i][&#39;Id&#39;]; ?&gt;&quot; class=&quot;btn btn-md btn-info&quot;&gt;编辑&lt;/a&gt;
</code></pre>
<blockquote>
<p> 此时，即可点击某条数据编辑时，跳转到update.php页面，并把这条数据的编号通过url传递过去</p>
</blockquote>
<ul>
<li>来到<code>update.php</code>，在<code>90</code>行处<code>&lt;form&gt;</code>标签开始的地方，添加以下代码</li>
</ul>
<pre><code class="lang-php+HTML">      &lt;!-- 从这开始是修改界面核心输入数据部分 --&gt;
      &lt;?php
        //拿到传递过来的id
        $id = $_GET[&#39;id&#39;];
        //打开数据库
        $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);
        //准备sql语句
        $sql = &quot;select *from hero_recycle where id=&#39;$id&#39;&quot;;
        //执行查询
        $result = mysqli_query($link,$sql);
        //得到数组结果,因为只会有一条数据，所以直接取下标0，直接取到那条数据
        $data = mysqli_fetch_all($result,1)[0];
        //关闭数据库
        mysqli_close($link);
      ?&gt;
</code></pre>
<ul>
<li>依次在下面表单中的各种输入框中加value值（用PHP输出数据），代码如下：</li>
</ul>
<pre><code class="lang-php+HTML">      &lt;form action=&quot;doUpdate.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon1&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-cutlery&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;!-- 这里显示数据 --&gt;
          &lt;input type=&quot;text&quot; value=&quot;&lt;?php echo $data[&#39;heroName&#39;];?&gt;&quot; name=&#39;heroName&#39; class=&quot;form-control&quot; placeholder=&quot;请输入人员姓名&quot; aria-describedby=&quot;basic-addon1&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-thumbs-up&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;!-- 这里显示数据 --&gt;
          &lt;input type=&quot;text&quot; value=&quot;&lt;?php echo $data[&#39;heroSkill&#39;];?&gt;&quot; name=&#39;heroSkill&#39; class=&quot;form-control&quot; placeholder=&quot;请输入技能名&quot; aria-describedby=&quot;basic-addon2&quot; required&gt;
        &lt;/div&gt;
        &lt;div class=&quot;input-group&quot;&gt;
          &lt;span class=&quot;input-group-addon&quot; id=&quot;basic-addon2&quot;&gt;
            &lt;span class=&#39;glyphicon glyphicon-picture&#39;&gt;&lt;/span&gt;
          &lt;/span&gt;
          &lt;input type=&quot;file&quot; name=&#39;heroIcon&#39; class=&quot;form-control&quot; aria-describedby=&quot;&quot; required&gt;
        &lt;/div&gt;

        &lt;div class=&quot;form-group&quot;&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;保存&lt;/button&gt;
          &lt;a href=&#39;#&#39; class=&quot;btn btn-danger&quot;&gt;取消&lt;/a&gt;
        &lt;/div&gt;
      &lt;/form&gt;
</code></pre>
<h4 id="5-4-">5.4 完成保存修改</h4>
<ul>
<li>现在，我们已经完成了进入编辑界面时，带入原数据。接下来，我们需要完成点击保存，就完成修改更新。</li>
<li>分析：</li>
</ul>
<pre><code>    所有要更新的数据都是在一张表单里，当点击保存时，即提交表单，提交地址在  doUpdate.php这个页面。使用POST请求提交。但是，修改某条数据，还需要根据id找到某条数据，提交到 doUpdate.php时并没有id，因此我们还需要来到update.php界面，把id也一并提交过来
</code></pre><ul>
<li>修改<code>update.php</code>代码，在form表单下面，新增一个隐藏的input，值为id，代码如下：</li>
</ul>
<pre><code class="lang-php+HTML">  &lt;!-- 因为id不需要用户修改，所以隐藏 --&gt;
  &lt;input type=&quot;text&quot; value=&quot;&lt;?php echo $data[&#39;Id&#39;];?&gt;&quot; name=&quot;id&quot; style=&quot;display:none&quot; &gt;
</code></pre>
<ul>
<li>然后我们处理更新业务，新建一个 <code>doUpdate.php</code>文件，代码如下：</li>
</ul>
<pre><code class="lang-php">&lt;?php

    //接收文件名
    $fileName = $_FILES[&#39;heroIcon&#39;][&#39;name&#39;];

    //找到临时保存的文件
    $tmp = $_FILES[&#39;heroIcon&#39;][&#39;tmp_name&#39;];

    //转换成gbk编码的文件名
    $gbkName = iconv(&#39;utf-8&#39;,&#39;gbk&#39;,$fileName);

    //拼接要永久保存图片的路径
    $path = &#39;./imgs/icon/&#39;.$gbkName;

    //移动到图片文件夹永久保存
    move_uploaded_file($tmp,$path);

    //连接数据库
    $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);

    //得到id
    $id = $_POST[&#39;id&#39;];

    //得到名字
    $name = $_POST[&#39;heroName&#39;];
    //得到技能
    $skill = $_POST[&#39;heroSkill&#39;];

    //修改数据
    $sql = &quot;update hero_recycle set heroName=&#39;$name&#39;,heroIcon=&#39;$path&#39;,heroSkill=&#39;$skill&#39; where id=&#39;$id&#39;&quot;;

    //执行语句
    $result = mysqli_query($link,$sql);

    //获得受影响行数
    $rows = mysqli_affected_rows($link);

    //关闭连接
    mysqli_close($link);    

    //如果成功
    if($rows &gt; 0){

        //返回首页
        header(&#39;location:index.php&#39;);

    }else{

        echo &#39;修改失败！！！&#39;;
    }
?&gt;
</code></pre>
<h3 id="6-">6. 回收站功能</h3>
<blockquote>
<p>根据最初的分析：我们在首页 <code>index.php</code>里如果对数据点击了删除，会把数据放入<code>回收站</code>，因此，我们接下来需要在首页里，完成删除</p>
</blockquote>
<h4 id="6-1-">6.1 完成放入回收站</h4>
<p>来到 <code>index.php</code> 在143行，把源代码</p>
<pre><code class="lang-html">&lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;删除&lt;/a&gt;
</code></pre>
<p>修改为</p>
<pre><code class="lang-php+HTML">&lt;a href=&quot;doDelete.php?id=&lt;?php echo $data[$i][&#39;Id&#39;]; ?&gt;&quot; class=&quot;btn btn-md btn-danger&quot;&gt;删除&lt;/a&gt;
</code></pre>
<p>解释：</p>
<pre><code>我们点击删除后，就跳转到doDelete.php页面去处理，但是，需要带入想要放到回收站的数据id，才方便在doDelete.php页面里处理时知道具体要删哪条数据
</code></pre><ul>
<li>新建  <code>doDelete.php</code>文件，代码如下：</li>
</ul>
<pre><code class="lang-php">&lt;?php

    //连接数据库
    $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);

    //得到要加入回收站的数据id
    $id = $_GET[&#39;id&#39;];

    //修改数据，标记为加入回收站
    $sql = &quot;update hero_recycle set isDelete=&#39;yes&#39; where id=&#39;$id&#39;&quot;;

    //执行语句
    $result = mysqli_query($link,$sql);

    //获得受影响行数
    $rows = mysqli_affected_rows($link);

    //关闭连接
    mysqli_close($link);    

    //如果成功
    if($rows &gt; 0){

        //返回首页
        header(&#39;location:index.php&#39;);

    }else{

        echo &#39;删除失败！！！&#39;;
    }

?&gt;
</code></pre>
<p>大体过程：</p>
<p>​    1.取到get提交来的id</p>
<p>​    2.根据id找到数据库中这条记录，并把isDelete字段设置为yes</p>
<p>​    3.修改成功则返回首页</p>
<h4 id="6-2-">6.2 在回收站显示所有回收数据</h4>
<p>​    经过上一个步骤，已经实现了把一些数据加到回收站的功能，但如果想再回收站看到这些数据怎么办呢？</p>
<p>我们还需要一个回收站界面，因此新建<code>recycle.php</code>文件，代码如下</p>
<pre><code class="lang-php+HTML">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;zh-cn&quot;&gt;

&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
  &lt;title&gt;Bootstrap 101 Template&lt;/title&gt;

  &lt;!-- Bootstrap --&gt;
  &lt;link href=&quot;lib/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;

  &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
  &lt;!-- WARNING: Respond.js doesn&#39;t work if you view the page via file:// --&gt;
  &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
      &lt;![endif]--&gt;
  &lt;style&gt;
    .input-group {
      margin: 20px 0;
    }

    .form-group {
      display: flex;
    }

    .form-group&gt;* {
      flex: 1;
      margin: 10px;
    }

    table {
      background-color: white;
    }

    a {
      text-decoration: none !important;
    }

    table {
      font-size: 25px;
    }

    td {
      vertical-align: middle !important;
    }

    tr td:last-child {
      text-align: center;
    }

    img {
      width: 140px !important;
    }
  &lt;/style&gt;
&lt;/head&gt;

&lt;body class=&#39;bg-success&#39;&gt;
  &lt;nav class=&quot;navbar navbar-default&quot;&gt;
    &lt;div class=&quot;container-fluid&quot;&gt;
      &lt;!-- Brand and toggle get grouped for better mobile display --&gt;
      &lt;div class=&quot;navbar-header&quot;&gt;
        &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot;
          aria-expanded=&quot;false&quot;&gt;
          &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
        &lt;/button&gt;
        &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;英雄管理--
          &lt;span&gt;回收站&lt;/span&gt;
        &lt;/a&gt;
      &lt;/div&gt;

      &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;
      &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt;
        &lt;ul class=&quot;nav navbar-nav&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;首页&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;新增&lt;/a&gt;
          &lt;/li&gt;

        &lt;/ul&gt;
        &lt;form class=&quot;navbar-form navbar-left&quot; style=&quot;margin:0&quot; role=&quot;search&quot;&gt;
          &lt;div class=&quot;form-group&quot;&gt;
            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Search&quot;&gt;
          &lt;/div&gt;
          &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;搜索&lt;/button&gt;
        &lt;/form&gt;
        &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt;
          &lt;li&gt;
            &lt;a href=&quot;#&quot;&gt;回收站&lt;/a&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
      &lt;!-- /.navbar-collapse --&gt;
    &lt;/div&gt;
    &lt;!-- /.container-fluid --&gt;
  &lt;/nav&gt;
  &lt;div class=&quot;container&quot;&gt;

    &lt;table class=&quot;table table-bordered  table-striped&quot;&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th width=&#39;10%&#39;&gt;序号&lt;/th&gt;
          &lt;th width=&#39;10%&#39;&gt;姓名&lt;/th&gt;
          &lt;th width=&#39;10%&#39;&gt;头像&lt;/th&gt;
          &lt;th width=&#39;55%&#39;&gt;技能&lt;/th&gt;
          &lt;th width=&#39;20%&#39;&gt;管理&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;!-- 这里开始我们要写代码获取回收站数据并显示出来 --&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;jack&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2444417686,1560113072&amp;fm=58&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;擅长游泳&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;还原&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;粉碎&lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;jack&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=3285008674,1557983093&amp;fm=27&amp;gp=0.jpg&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;擅长游泳&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;还原&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;粉碎&lt;/a&gt;
          &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
&lt;!-- jQuery (necessary for Bootstrap&#39;s JavaScript plugins) --&gt;
&lt;script src=&quot;lib/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;
&lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;
&lt;script src=&quot;lib/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>此时仅仅只是有个界面在这，我们还需要去数据库查出所有被放入回收站的数据并显示出来，因此从第115行tbody部分开始，写如下代码：</p>
<pre><code class="lang-php+HTML">      &lt;tbody&gt;
      &lt;?php

       //连接数据库
       $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);
       //查询数据的sql语句（查询出所有在回收站的数据）
       $sql = &quot;select * from hero_recycle where isDelete=&#39;yes&#39;&quot;;

       //执行语句
       $result = mysqli_query($link,$sql);

       //拿到结果
       $data = mysqli_fetch_all($result,1);
       //关闭连接
       mysqli_close($link);    

       //遍历查到的所有数据
       for($i = 0; $i &lt; count($data); $i++):
      ?&gt;
      &lt;!-- 根据数据生成表格 --&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;Id&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;heroName&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;
            &lt;img src=&quot;&lt;?php echo $data[$i][&#39;heroIcon&#39;];?&gt;&quot; alt=&quot;&quot;&gt;
          &lt;/td&gt;
          &lt;td&gt;&lt;?php echo $data[$i][&#39;heroSkill&#39;]; ?&gt;&lt;/td&gt;
          &lt;td&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;还原&lt;/a&gt;
            &lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;粉碎&lt;/a&gt;
          &lt;/td&gt;
      &lt;/tr&gt;
      &lt;?php endfor; ?&gt;
      &lt;/tbody&gt;
</code></pre>
<p>大体过程：</p>
<p>​    1.找出所有数据库中isDelete为yes的数据</p>
<p>​    2.循环遍历这些数据，每条数据都是一个tr，依次把数据做成td</p>
<p>最后，回到<code>index.php</code>，在第94行</p>
<p>原代码</p>
<pre><code class="lang-html"> &lt;a href=&quot;#&quot;&gt;回收站&lt;/a&gt;
</code></pre>
<p>修改为</p>
<pre><code class="lang-html"> &lt;a href=&quot;recycle.php&quot;&gt;回收站&lt;/a&gt;
</code></pre>
<p>这个步骤后，我们就可以在首页点击<code>回收站</code>进入它的界面，看到加入在回收站的数据了。</p>
<h4 id="6-3-">6.3 还原功能</h4>
<p>​    <img src="media/1523516453948.png" alt="1523516453948"></p>
<p>此时，如果想点击还原，把数据从回收站还原。那么接下来，我们需要做以下步骤</p>
<p>来到<code>recycle.php</code>，把144行的</p>
<pre><code class="lang-html">&lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-info&quot;&gt;还原&lt;/a&gt;
</code></pre>
<p>修改为</p>
<pre><code class="lang-php+HTML">&lt;a href=&quot;doBack.php?id=&lt;?php echo $data[$i][&#39;id&#39;]; ?&gt;&quot; class=&quot;btn btn-md btn-info&quot;&gt;还原&lt;/a&gt;
</code></pre>
<p>这个步骤的目的是：当点击还原按钮会把需要还原数据的<code>id</code>传递到<code>doBack.php</code>页面进行还原操作处理</p>
<p>然后新建<code>doBack.php</code>页面，代码如下：</p>
<pre><code class="lang-php">&lt;?php

    //连接数据库
    $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);

    //得到要复原的数据id
    $id = $_GET[&#39;id&#39;];

    //修改数据，标记为加入回收站
    $sql = &quot;update hero_recycle set isDelete=&#39;no&#39; where id=&#39;$id&#39;&quot;;

    //执行语句
    $result = mysqli_query($link,$sql);

    //获得受影响行数
    $rows = mysqli_affected_rows($link);

    //关闭连接
    mysqli_close($link);    

    //如果成功
    if($rows &gt; 0){

        //返回回收站
        header(&#39;location:recycle.php&#39;);

    }else{

        echo &#39;还原失败！！！&#39;;
    }

?&gt;
</code></pre>
<p>解析：根据代码可以发现，其实跟放入回收站的代码几乎一样。</p>
<p>只是把isDelete标识从yes改回no</p>
<h4 id="6-4-">6.4 粉碎功能</h4>
<p><img src="media/1523516923236.png" alt="1523516923236"></p>
<p>此时我们要实现在回收站中，点粉碎，把数据彻底删除。</p>
<p>那么首先，来到<code>recycle.php</code>,在145行代码中，把</p>
<pre><code class="lang-html">&lt;a href=&quot;#&quot; class=&quot;btn btn-md btn-danger&quot;&gt;粉碎&lt;/a&gt;
</code></pre>
<p>修改为</p>
<pre><code class="lang-php+HTML">&lt;a href=&quot;doBreak.php?id=&lt;?php echo $data[$i][&#39;Id&#39;]; ?&gt;&quot; class=&quot;btn btn-md btn-danger&quot;&gt;粉碎&lt;/a&gt;
</code></pre>
<p>这个步骤后：点击粉碎会把要彻底删除数据的id传递到<code>doBreak.php</code>页面去处理</p>
<p>因此，我们还需要新建个<code>doBreak.php</code>页面，代码如下：</p>
<pre><code class="lang-php">&lt;?php

    //连接数据库
    $link = mysqli_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;,&#39;test&#39;);

    //得到要加入回收站的数据id
    $id = $_GET[&#39;id&#39;];

    //修改数据，标记为加入回收站
    $sql = &quot;delete from hero_recycle where id=&#39;$id&#39;&quot;;

    //执行语句
    $result = mysqli_query($link,$sql);

    //获得受影响行数
    $rows = mysqli_affected_rows($link);

    //关闭连接
    mysqli_close($link);    

    //如果成功
    if($rows &gt; 0){

        //返回首页
        header(&#39;location:recycle.php&#39;);

    }else{

        echo &#39;粉碎失败！！！&#39;;
    }

?&gt;
</code></pre>
<p>逻辑解释：</p>
<p>​    根据拿到的id，然后通过id去数据库删除对应数据。</p>

          	</article>
        </div>
		</div>
  </body>
</html>
<script type="text/javascript" src="toc/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="toc/js/jquery.ztree.all-3.5.min.js"></script>
<script type="text/javascript" src="toc/js/ztree_toc.js"></script>
<script type="text/javascript" src="toc_conf.js"></script>

<SCRIPT type="text/javascript" >
<!--
$(document).ready(function(){
    var css_conf = eval(markdown_panel_style);
    $('#readme').css(css_conf)
    
    var conf = eval(jquery_ztree_toc_opts);
		$('#tree').ztree_toc(conf);
});
//-->
</SCRIPT>